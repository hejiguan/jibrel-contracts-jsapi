'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),exports.totalSupply=totalSupply,exports.balanceOf=balanceOf,exports.transfer=transfer,exports.allEvents=allEvents,exports.getPastEvents=getPastEvents,exports.Transfer=Transfer,exports.estimateGas=estimateGas;var _bluebird=require('bluebird'),_bluebird2=_interopRequireDefault(_bluebird),_initWeb=require('./utils/initWeb3'),_initWeb2=_interopRequireDefault(_initWeb),_submitContractTx=require('./utils/submitContractTx'),_submitContractTx2=_interopRequireDefault(_submitContractTx),_getContractInstance=require('./utils/getContractInstance'),_getContractInstance2=_interopRequireDefault(_getContractInstance),_estimateGasForContractMethod=require('./utils/estimateGasForContractMethod'),_estimateGasForContractMethod2=_interopRequireDefault(_estimateGasForContractMethod),_eventUtils=require('./utils/eventUtils'),_checkParam=require('./utils/checkParam');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var contractInterface='ERC20';function totalSupply(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress;(0,_initWeb2.default)(b,c);var e=(0,_getContractInstance2.default)(d,contractInterface);return _bluebird2.default.promisify(e.totalSupply.call)()}function balanceOf(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.owner;(0,_initWeb2.default)(b,c);var f=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamAddress)(e),_bluebird2.default.promisify(f.balanceOf.call)(e)}function transfer(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.privateKey,f=a.gasLimit,g=a.to,h=a.value;(0,_initWeb2.default)(b,c);var i=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamPrivateKey)(e),(0,_checkParam.checkParamNumber)(f,'gasLimit'),(0,_checkParam.checkParamAddress)(g),(0,_checkParam.checkParamNumber)(h,'value'),(0,_submitContractTx2.default)({privateKey:e,gasLimit:f,args:[g,h],method:i.transfer})}function allEvents(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.options,f=a.callback;(0,_initWeb2.default)(b,c);var g=(0,_getContractInstance2.default)(d,contractInterface);return null!=e&&(0,_checkParam.checkParamObject)(e,'options',['filter']),null!=f&&(0,_checkParam.checkParamFunction)(f,'callback'),(0,_eventUtils.subscribeToContractEvent)(g.allEvents,e,f)}function getPastEvents(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.event,f=a.options;(0,_initWeb2.default)(b,c);var g=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamStr)(e,'event'),null!=f&&(0,_checkParam.checkParamObject)(f,'options',['filter']),(0,_eventUtils.getPastContractEvents)(g[e],f)}function Transfer(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.options,f=a.callback;(0,_initWeb2.default)(b,c);var g=(0,_getContractInstance2.default)(d,contractInterface);return null!=e&&(0,_checkParam.checkParamObject)(e,'options',['filter']),null!=f&&(0,_checkParam.checkParamFunction)(f,'callback'),(0,_eventUtils.subscribeToContractEvent)(g.Transfer,e,f)}function estimateGas(a){return(0,_estimateGasForContractMethod2.default)(contractInterface,a)}'use strict',Object.defineProperty(exports,'__esModule',{value:!0}),exports.isRegulated=isRegulated,exports.isReceivingAllowed=isReceivingAllowed,exports.isSpendingAllowed=isSpendingAllowed,exports.isTransferAllowed=isTransferAllowed,exports.isApproveAllowed=isApproveAllowed,exports.isApprovedSpendingAllowed=isApprovedSpendingAllowed,exports.isTransferFromAllowed=isTransferFromAllowed,exports.estimateGas=estimateGas;var _bluebird=require('bluebird'),_bluebird2=_interopRequireDefault(_bluebird),_initWeb=require('./utils/initWeb3'),_initWeb2=_interopRequireDefault(_initWeb),_getContractInstance=require('./utils/getContractInstance'),_getContractInstance2=_interopRequireDefault(_getContractInstance),_checkParam=require('./utils/checkParam'),_estimateGasForContractMethod=require('./utils/estimateGasForContractMethod'),_estimateGasForContractMethod2=_interopRequireDefault(_estimateGasForContractMethod);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var contractInterface='ERC20Validatable';function isRegulated(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress;(0,_initWeb2.default)(b,c);var e=(0,_getContractInstance2.default)(d,contractInterface);return _bluebird2.default.promisify(e.isRegulated.call)()}function isReceivingAllowed(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.account,f=a.value;(0,_initWeb2.default)(b,c);var g=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamAddress)(e),(0,_checkParam.checkParamNumber)(f,'value'),_bluebird2.default.promisify(g.isReceivingAllowed.call)(e,f)}function isSpendingAllowed(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.account,f=a.value;(0,_initWeb2.default)(b,c);var g=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamAddress)(e),(0,_checkParam.checkParamNumber)(f,'value'),_bluebird2.default.promisify(g.isSpendingAllowed.call)(e,f)}function isTransferAllowed(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.from,f=a.to,g=a.value;(0,_initWeb2.default)(b,c);var h=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamAddress)(e),(0,_checkParam.checkParamAddress)(f),(0,_checkParam.checkParamNumber)(g,'value'),_bluebird2.default.promisify(h.isTransferAllowed.call)(e,f,g)}function isApproveAllowed(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.from,f=a.spender,g=a.value;(0,_initWeb2.default)(b,c);var h=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamAddress)(e),(0,_checkParam.checkParamAddress)(f),(0,_checkParam.checkParamNumber)(g,'value'),_bluebird2.default.promisify(h.isApproveAllowed.call)(e,f,g)}function isApprovedSpendingAllowed(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.from,f=a.spender,g=a.value;(0,_initWeb2.default)(b,c);var h=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamAddress)(e),(0,_checkParam.checkParamAddress)(f),(0,_checkParam.checkParamNumber)(g,'value'),_bluebird2.default.promisify(h.isApprovedSpendingAllowed.call)(e,f,g)}function isTransferFromAllowed(a){var b=a.rpcaddr,c=a.rpcport,d=a.contractAddress,e=a.spender,f=a.from,g=a.to,h=a.value;(0,_initWeb2.default)(b,c);var i=(0,_getContractInstance2.default)(d,contractInterface);return(0,_checkParam.checkParamAddress)(e),(0,_checkParam.checkParamAddress)(f),(0,_checkParam.checkParamAddress)(g),(0,_checkParam.checkParamNumber)(h,'value'),_bluebird2.default.promisify(i.isTransferFromAllowed.call)(e,f,g,h)}function estimateGas(a){return(0,_estimateGasForContractMethod2.default)(contractInterface,a)}'use strict',Object.defineProperty(exports,'__esModule',{value:!0});var _objectWithoutProperties2=require('babel-runtime/helpers/objectWithoutProperties'),_objectWithoutProperties3=_interopRequireDefault(_objectWithoutProperties2);exports.sendTransaction=sendTransaction,exports.getBalance=getBalance,exports.estimateGas=estimateGas;var _bluebird=require('bluebird'),_bluebird2=_interopRequireDefault(_bluebird),_initWeb=require('./utils/initWeb3'),_initWeb2=_interopRequireDefault(_initWeb),_submitTx=require('./utils/submitTx'),_submitTx2=_interopRequireDefault(_submitTx),_txUtils=require('./utils/txUtils'),_checkParam=require('./utils/checkParam');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function sendTransaction(a){var b=a.rpcaddr,c=a.rpcport,d=(0,_objectWithoutProperties3.default)(a,['rpcaddr','rpcport']);return(0,_initWeb2.default)(b,c),(0,_submitTx2.default)(d)}function getBalance(a){var b=a.rpcaddr,c=a.rpcport,d=a.address,e=a.defaultBlock;return(0,_initWeb2.default)(b,c),(0,_checkParam.checkParamAddress)(d),(0,_checkParam.checkParamAddress)(e),_bluebird2.default.promisify(web3.eth.getBalance)(d,e)}function estimateGas(a){var b=a.rpcaddr,c=a.rpcport,d=a.data,e=a.to,f=a.value;return(0,_initWeb2.default)(b,c),(0,_checkParam.checkParamStr)(d,'data'),(0,_checkParam.checkParamAddress)(e),(0,_checkParam.checkParamNumber)(f,'value'),(0,_txUtils.getGasLimit)({data:d,to:e,value:f})}'use strict',Object.defineProperty(exports,'__esModule',{value:!0});var _typeof2=require('babel-runtime/helpers/typeof'),_typeof3=_interopRequireDefault(_typeof2);exports.checkParamNumber=checkParamNumber,exports.checkParamStr=checkParamStr,exports.checkParamObject=checkParamObject,exports.checkParamArray=checkParamArray,exports.checkParamFunction=checkParamFunction,exports.checkParamAddress=checkParamAddress,exports.checkParamPrivateKey=checkParamPrivateKey;function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function checkParamNumber(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:0;if(!(null!=a&&'number'==typeof a&&a>c&&(!d||a===d)))throw new Error(b+' is not found or invalid')}function checkParamStr(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:0,e=a.length>c,f=!d||a.length===d;if(!(null!=a&&'string'==typeof a&&e&&f))throw new Error(b+' is not found or invalid')}function checkParamObject(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[],d='object'===('undefined'==typeof a?'undefined':(0,_typeof3.default)(a));if(!(null!=a&&d))throw new Error(b+' is not found or invalid');c.forEach(function(c){if(null==a[c])throw new Error('Required field '+c+' of '+b+' is not found')})}function checkParamArray(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;checkParamObject(a,b);var d=Array.isArray(a),e=a.length>c;if(!(d&&e))throw new Error(b+' is not found or invalid')}function checkParamFunction(a,b){if(!(null!=a&&'function'==typeof a))throw new Error(b+' is not found or invalid')}function checkParamAddress(a){if(!web3.isAddress(a))throw new Error('Provided address is invalid')}function checkParamPrivateKey(a){checkParamStr(a,'privateKey',0,64);var b=/^[a-z0-9]+$/,c=/^[A-Z0-9]+$/;if(!(b.test(a)||c.test(a)))throw new Error('Private key has invalid format')}'use strict',Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=estimateGasForContractMethod;var _initWeb=require('./initWeb3'),_initWeb2=_interopRequireDefault(_initWeb),_txUtils=require('./txUtils'),_getContractInstance=require('./getContractInstance'),_getContractInstance2=_interopRequireDefault(_getContractInstance),_checkParam=require('./checkParam');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function estimateGasForContractMethod(a,b){var c=b.rpcaddr,d=b.rpcport,e=b.contractAddress,f=b.method,g=b.args;(0,_initWeb2.default)(c,d);var h=(0,_getContractInstance2.default)(e,a);return(0,_checkParam.checkParamStr)(f,'method'),(0,_checkParam.checkParamArray)(g,'args'),(0,_txUtils.getContractGasLimit)(h[f],null,g)}'use strict',Object.defineProperty(exports,'__esModule',{value:!0});var _objectWithoutProperties2=require('babel-runtime/helpers/objectWithoutProperties'),_objectWithoutProperties3=_interopRequireDefault(_objectWithoutProperties2);exports.subscribeToContractEvent=subscribeToContractEvent,exports.getPastContractEvents=getPastContractEvents;var _bluebird=require('bluebird'),_bluebird2=_interopRequireDefault(_bluebird),_events=require('events'),_events2=_interopRequireDefault(_events);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function subscribeToContractEvent(a,b,c){var d=new _events2.default,e=b.filter,f=(0,_objectWithoutProperties3.default)(b,['filter']);return a(e,f,function(a,b){return a?(d.emit('error',a),void c(a)):void(d.emit('data',b),c(null,b))}),d}function getPastContractEvents(a,b){var c=b.filter,d=(0,_objectWithoutProperties3.default)(b,['filter']),e=a(c,d);return _bluebird2.default.promisify(e.get)()}'use strict',Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=getAddressFromPrivateKey;var _cryptoJs=require('crypto-js'),_cryptoJs2=_interopRequireDefault(_cryptoJs),_elliptic=require('elliptic');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var ec=new _elliptic.ec('secp256k1');function getAddressFromPrivateKey(a){var b=ec.genKeyPair();b._importPrivate(a,'hex');var c=b.getPublic(!1,'hex').slice(2),d=_cryptoJs2.default.enc.Hex.parse(c),e=_cryptoJs2.default.SHA3(d,{outputLength:256}),f=e.toString(_cryptoJs2.default.enc.Hex).slice(24);return f}'use strict',Object.defineProperty(exports,'__esModule',{value:!0});var _memoize=require('./memoize'),_memoize2=_interopRequireDefault(_memoize),_checkParam=require('./checkParam');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var ERC20ABI=[{constant:!1,inputs:[{name:'_spender',type:'address'},{name:'_value',type:'uint256'}],name:'approve',outputs:[{name:'success',type:'bool'}],payable:!1,type:'function'},{constant:!0,inputs:[],name:'totalSupply',outputs:[{name:'',type:'uint256'}],payable:!1,type:'function'},{constant:!1,inputs:[{name:'_from',type:'address'},{name:'_to',type:'address'},{name:'_value',type:'uint256'}],name:'transferFrom',outputs:[{name:'success',type:'bool'}],payable:!1,type:'function'},{constant:!0,inputs:[{name:'_owner',type:'address'}],name:'balanceOf',outputs:[{name:'balance',type:'uint256'}],payable:!1,type:'function'},{constant:!1,inputs:[{name:'_to',type:'address'},{name:'_value',type:'uint256'}],name:'transfer',outputs:[{name:'success',type:'bool'}],payable:!1,type:'function'},{constant:!0,inputs:[{name:'_owner',type:'address'},{name:'_spender',type:'address'}],name:'allowance',outputs:[{name:'remaining',type:'uint256'}],payable:!1,type:'function'},{anonymous:!1,inputs:[{indexed:!0,name:'from',type:'address'},{indexed:!0,name:'to',type:'address'},{indexed:!1,name:'value',type:'uint256'}],name:'Transfer',type:'event'},{anonymous:!1,inputs:[{indexed:!0,name:'owner',type:'address'},{indexed:!0,name:'spender',type:'address'},{indexed:!1,name:'value',type:'uint256'}],name:'Approval',type:'event'}],ERC20ValidatableABI=[{constant:!0,inputs:[{name:'_account',type:'address'},{name:'_value',type:'uint256'}],name:'isReceivingAllowed',outputs:[{name:'',type:'bool'}],payable:!1,type:'function'},{constant:!0,inputs:[{name:'_spender',type:'address'},{name:'_from',type:'address'},{name:'_to',type:'address'},{name:'_value',type:'uint256'}],name:'isTransferFromAllowed',outputs:[{name:'',type:'bool'}],payable:!1,type:'function'},{constant:!0,inputs:[{name:'_account',type:'address'},{name:'_value',type:'uint256'}],name:'isSpendingAllowed',outputs:[{name:'',type:'bool'}],payable:!1,type:'function'},{constant:!0,inputs:[{name:'_from',type:'address'},{name:'_spender',type:'address'},{name:'_value',type:'uint256'}],name:'isApproveAllowed',outputs:[{name:'',type:'bool'}],payable:!1,type:'function'},{constant:!0,inputs:[{name:'_from',type:'address'},{name:'_spender',type:'address'},{name:'_value',type:'uint256'}],name:'isApprovedSpendingAllowed',outputs:[{name:'',type:'bool'}],payable:!1,type:'function'},{constant:!0,inputs:[{name:'_from',type:'address'},{name:'_to',type:'address'},{name:'_value',type:'uint256'}],name:'isTransferAllowed',outputs:[{name:'',type:'bool'}],payable:!1,type:'function'}];function _getContract(a){if((0,_checkParam.checkParamStr)(a,'contractInterface'),'ERC20'===a)return web3.eth.contract(ERC20ABI);if('ERC20Validatable'===a)return web3.eth.contract(ERC20ValidatableABI);throw new Error('ABI for the contractInterface '+a+' not found')}var getContract=(0,_memoize2.default)(_getContract);function _getContractInstance(a,b){(0,_checkParam.checkParamAddress)(a);var c=getContract(b);return c.at(a)}var getContractInstance=(0,_memoize2.default)(_getContractInstance);exports.default=getContractInstance,'use strict',Object.defineProperty(exports,'__esModule',{value:!0});var _keys=require('babel-runtime/core-js/object/keys'),_keys2=_interopRequireDefault(_keys);exports.default=initWeb3;var _web=require('web3'),_web2=_interopRequireDefault(_web),_checkParam=require('./checkParam');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function initWeb3(a,b){if(!isWeb3Injected()){var c=getRPCEndpoint(a,b),d=new _web2.default(new _web2.default.providers.HttpProvider(c));setGlobalWeb3(d)}}function isWeb3Injected(){var a='undefined'==typeof window?global:window;return!!a.isWeb3Injected||checkWeb3IsConnected(a.web3)}function getRPCEndpoint(a,b){return checkWeb3ConnectionParams({rpcaddr:a,rpcport:b}),'http://'+a+':'+b}function setGlobalWeb3(a){var b='undefined'==typeof window?global:window;if(!checkWeb3IsConnected(a))throw new Error('Could not set web3 as global object because it is not connected to the node');b.web3=a,b.isWeb3Injected=!0}function checkWeb3IsConnected(a){var b=a&&a.isConnected();return!!b&&checkWeb3ethSupportedMethods(a)}function checkWeb3ethSupportedMethods(a){var b=a.eth;if(!b)throw new Error('web3.eth is not supported');return['getBalance','contract','sendRawTransaction','getTransactionCount','getGasPrice','estimateGas'].forEach(function(a){if(!(a in b))throw new Error('web3.eth.'+a+' is not supported')}),!0}function checkWeb3ConnectionParams(a){(0,_keys2.default)(a).forEach(function(b){return(0,_checkParam.checkParamStr)(b,a[b])})}'use strict',Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=memoize;function memoize(a){var b={};return function(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];var f=d.join(':');if(f in b)return b[f];var g=a.apply(void 0,d);return b[f]=g,g}}'use strict',Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=signTx;var _ethereumjsTx=require('ethereumjs-tx'),_ethereumjsTx2=_interopRequireDefault(_ethereumjsTx);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function signTx(a,b){var c=new _ethereumjsTx2.default(a);return c.sign(new Buffer(b,'hex')),c.serialize().toString('hex')}'use strict',Object.defineProperty(exports,'__esModule',{value:!0});var _regenerator=require('babel-runtime/regenerator'),_regenerator2=_interopRequireDefault(_regenerator),_toConsumableArray2=require('babel-runtime/helpers/toConsumableArray'),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2),_asyncToGenerator2=require('babel-runtime/helpers/asyncToGenerator'),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),getRawTx=function(){var a=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function a(b,c,d,e){return _regenerator2.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=c,a.next=3,(0,_txUtils.getGasPrice)();case 3:return a.t1=a.sent,a.next=6,(0,_txUtils.getTxCount)(d);case 6:if(a.t2=a.sent,null==e){a.next=11;break}a.t3=e,a.next=14;break;case 11:return a.next=13,(0,_txUtils.getContractGasLimit)(b,c);case 13:a.t3=a.sent;case 14:return a.t4=a.t3,a.abrupt('return',{data:a.t0,gasPrice:a.t1,nonce:a.t2,gasLimit:a.t4});case 16:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),_bluebird=require('bluebird'),_bluebird2=_interopRequireDefault(_bluebird),_signTx=require('./signTx'),_signTx2=_interopRequireDefault(_signTx),_txUtils=require('./txUtils'),_getAddressFromPrivateKey=require('./getAddressFromPrivateKey'),_getAddressFromPrivateKey2=_interopRequireDefault(_getAddressFromPrivateKey);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}exports.default=function(){var a=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function a(b){var c,d,e,f,g=b.method,h=b.args,i=b.privateKey,j=b.gasLimit;return _regenerator2.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=g.getData.apply(g,(0,_toConsumableArray3.default)(h)),d=(0,_getAddressFromPrivateKey2.default)(i),a.next=4,getRawTx(g,c,d,j);case 4:return e=a.sent,f=(0,_signTx2.default)(i,e),a.abrupt('return',_bluebird2.default.promisify(web3.eth.sendRawTransaction)(f));case 7:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),'use strict',Object.defineProperty(exports,'__esModule',{value:!0});var _regenerator=require('babel-runtime/regenerator'),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=require('babel-runtime/helpers/asyncToGenerator'),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),getRawTx=function(){var a=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function a(b){var c=b.gasLimit,d=b.address,e=b.data,f=b.to,g=b.value;return _regenerator2.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=e,a.t1=f,a.t2=g,a.next=5,(0,_txUtils.getGasPrice)();case 5:return a.t3=a.sent,a.next=8,(0,_txUtils.getTxCount)(d);case 8:if(a.t4=a.sent,null==c){a.next=13;break}a.t5=c,a.next=16;break;case 13:return a.next=15,(0,_txUtils.getGasLimit)({data:e,to:f,value:g});case 15:a.t5=a.sent;case 16:return a.t6=a.t5,a.abrupt('return',{data:a.t0,to:a.t1,value:a.t2,gasPrice:a.t3,nonce:a.t4,gasLimit:a.t6});case 18:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),_bluebird=require('bluebird'),_bluebird2=_interopRequireDefault(_bluebird),_signTx=require('./signTx'),_signTx2=_interopRequireDefault(_signTx),_txUtils=require('./txUtils'),_getAddressFromPrivateKey=require('./getAddressFromPrivateKey'),_getAddressFromPrivateKey2=_interopRequireDefault(_getAddressFromPrivateKey),_checkParam=require('./checkParam');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}exports.default=function(){var a=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function a(b){var c,d,e,f,g,h,i,j;return _regenerator2.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.privateKey,d=b.gasLimit,e=b.data,f=b.to,g=b.value,(0,_checkParam.checkParamAddress)(f),(0,_checkParam.checkParamPrivateKey)(c),(0,_checkParam.checkParamStr)(e,'data'),(0,_checkParam.checkParamNumber)(g,'value'),(0,_checkParam.checkParamNumber)(d,'gasLimit'),h=(0,_getAddressFromPrivateKey2.default)(c),a.next=9,getRawTx({gasLimit:d,address:h,data:e,to:f,value:g});case 9:return i=a.sent,j=(0,_signTx2.default)(c,i),a.abrupt('return',_bluebird2.default.promisify(web3.eth.sendRawTransaction)(j));case 12:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),'use strict',Object.defineProperty(exports,'__esModule',{value:!0});var _toConsumableArray2=require('babel-runtime/helpers/toConsumableArray'),_toConsumableArray3=_interopRequireDefault(_toConsumableArray2);exports.getTxCount=getTxCount,exports.getGasPrice=getGasPrice,exports.getGasLimit=getGasLimit,exports.getContractGasLimit=getContractGasLimit;var _bluebird=require('bluebird'),_bluebird2=_interopRequireDefault(_bluebird);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function getTxCount(a){return _bluebird2.default.promisify(web3.eth.getTransactionCount)(a)}function getGasPrice(){return _bluebird2.default.promisify(web3.eth.getGasPrice)()}function getGasLimit(a){return _bluebird2.default.promisify(web3.eth.estimateGas)(a)}function getContractGasLimit(a,b,c){var d=b&&b.length?b:a.getData.apply(a,(0,_toConsumableArray3.default)(c));return _bluebird2.default.promisify(a.estimateGas)({data:d})}